* Example project

Here's how you would run this HTTP echo JSON pretty printer service:

#+name: start-server
#+begin_src sh :eval no
mvn function:run
#+end_src

#+begin_src sh :results verbatim :noweb yes :exports none
<<start-server>> > /tmp/output.log &
echo $!
sleep 5
#+end_src

#+name: pid
#+RESULTS:
: 49961

#+begin_src sh :results verbatim :exports results
cat /tmp/output.log | tail -n 4
#+end_src

#+RESULTS:
: [INFO] jetty-9.4.26.v20200117; built: 2020-01-17T12:35:33.676Z; git: 7b38981d25d14afb4a12ff1f2596756144edf695; jvm 15.0.1+9
: [INFO] Started o.e.j.s.ServletContextHandler@2cd4e16a{/,null,AVAILABLE}
: [INFO] Started ServerConnector@340d6d89{HTTP/1.1,[http/1.1]}{0.0.0.0:8080}
: [INFO] Started @2799ms

Then test it with curl:

#+begin_src http :exports both
POST http://localhost:8080
Content-Type:application/json
Host: localhost
x-forwarded-for: 127.0.0.1
x-forwarded-proto: https

{"a": 1, "b": 3}
#+end_src

#+RESULTS:
: HTTP/1.1 200 OK
: Date: Wed, 10 Mar 2021 13:24:22 GMT
: Transfer-Encoding: chunked
: Server: Jetty(9.4.26.v20200117)
: 
: {
:   "a" : 1,
:   "b" : 3
: }


#+begin_src sh :var PID=pid :exports none
kill $PID
#+end_src

#+RESULTS:
